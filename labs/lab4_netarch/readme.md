# Архитектура сети  
______  
## Задание:
1. Разработаете и задокументируете адресное пространство для лабораторного стенда.  
2. Настроите ip адреса на каждом активном порту.  
3. Настроите каждый VPC в каждом офисе в своем VLAN.
4. Настроите VLAN/Loopbackup interface управления для сетевых устройств.  
5. Настроите сети офисов так, чтобы не возникало broadcast штормов, а использование линков было максимально оптимизировано
Используете IPv4. IPv6 по желанию.  
### Лабораторный стенд
  ![scheme](https://github.com/Alnor23/OTUS_NETWORK/blob/main/labs/lab4_netarch/screenshorts/main_scheme.png)
______
  Для формирования адресного пространства стенда были использованны следующие подходы:
   - все адреса IPv4 относятся к сети 10.0.0.0/8
   - иммитация глобальных адресов сеть 50.50.0.0/16
   - все глобальные адреса IPv6 относятся к сети 20FF:0DB8:ACAD::/48
   - все локальные адреса IPv6 относятся к сети FE80::/8
  
### Часть 1. Настройка и назначение адресов для маршрутизаторов.
Для обеспечения иерархической логической структуры при разработки адресации стенда, была реализована следующая схема:
### IPv4
  #### Москва  (10.1.0.0/16)  
  Сеть управления L3 устройствами 10.1.1.0/28   
  Сеть управления L2 устройствами 10.1.1.16/29   
  Сети между L3 устройствами 10.1.2.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)   
  Клиентская сеть VPC1 10.1.3.0/28    
  Клиентская сеть VPC7 10.1.3.16/28  
  Резервная сеть 10.1.4.0/24  
  #### СПБ (10.2.0.0/16)  
  Сеть управления L3 устройствами 10.2.1.0/28   
  Сеть управления L2 устройствами 10.2.1.16/29   
  Сети между L3 устройствами 10.2.2.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)  
  Клиентская сеть VPC8 10.2.3.0/28   
  Клиентская сеть VPC 10.2.3.16/28   
  Резервная сеть 10.2.4.0/24  
  #### Чокурдах  и Лабытнаги (10.3.0.0/16)  
  Сеть управления L3 устройствами 10.3.1.0/29   
  Сеть управления L2 устройствами 10.3.1.8/29  
  Сети между L3 устройствами  10.3.2.0/29 (c дальнейшей разбивкой на сети с 30 битной маской)   
  Клиентская сеть VPC30  10.3.3.0/28  
  Клиентская сеть VPC31  10.3.3.16/28   
  Резервная сеть 10.3.4.0/24  
  #### Триада  (10.10.0.0/16)  
  Сеть управления L3 устройствами 10.10.1.0/29  
  Сети между L3 устройствами  10.10.2.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)  
  Сеть для связи с AS офисами 50.50.1.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)  
  #### Киторн  (10.11.0.0/16)  
  Сеть управления L3 устройствами  10.11.1.0/29   
  Сеть для связи с AS офисами 50.50.2.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)  
  #### Ламас  (10.12.0.0/16)  
  Сеть управления L3 устройствами  10.12.1.0/29  
  Сеть для связи с AS офисами 50.50.3.0/24 (c дальнейшей разбивкой на сети с 30 битной маской)  
### IPv6       
  - Для сети управления последний хекстет будет соответствовать номеру интерфейса
  - Для сетей между устройств предпоследний хекстет будет соответствовать номеру устройства а последний номеру интерфейса   
  - В LLA последний хекстет будет соответствовать номеру устройства  
### Подробная таблица адресов   
#### Москва  
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|-----------------
R19    |    10.1.1.2   |255.255.255.240 |20FF:0DB8:ACAD:1001::19/64|FE80::19/8
R14    |    10.1.1.3   |255.255.255.240 |20FF:0DB8:ACAD:1001::14/64|FE80::14/8   
R12    |    10.1.1.4   |255.255.255.240 |20FF:0DB8:ACAD:1001::12/64|FE80::12/8     
R15    |    10.1.1.5   |255.255.255.240 |20FF:0DB8:ACAD:1001::15/64|FE80::15/8 
R13    |    10.1.1.6   |255.255.255.240 |20FF:0DB8:ACAD:1001::13/64|FE80::13/8 
R20    |    10.1.1.7   |255.255.255.240 |20FF:0DB8:ACAD:1001::20/64|FE80::20/8 
SW4    |    10.1.1.18  |255.255.255.248 |n/a                       |n/a
SW5    |    10.1.1.19  |255.255.255.248 |n/a                       |n/a 
SW3    |    10.1.1.20  |255.255.255.248 |n/a                       |n/a 
SW2    |    10.1.1.21  |255.255.255.248 |n/a                       |n/a 

Link
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R19    | e0/0 | IPv4         | 10.1.2.1/30                  | 10.1.2.0/30
R19    | e0/0 | IPv6         | 20FF:0DB8:ACAD:1000::19:/64  | 20FF:0DB8:ACAD:1000::/64
R14    | e0/3 | IPv4         | 10.1.2.2/30                  | 10.1.2.0/30 
R14    | e0/3 | IPv6         | 20FF:0DB8:ACAD:1000::14:3/64 | 20FF:0DB8:ACAD:1000::/64
||||
R14    | e0/0 | IPv4         | 10.1.2.9/30                  | 10.1.2.8/30 
R14    | e0/0 | IPv6         | 20FF:0DB8:ACAD:1011::14:/64  | 20FF:0DB8:ACAD:1011::/64
R12    | e0/2 | IPv4         | 10.1.2.10/30                 | 10.1.2.8/30 
R12    | e0/2 | IPv6         | 20FF:0DB8:ACAD:1011::12:2/64 | 20FF:0DB8:ACAD:1011::/64
||||
R14    | e0/1 | IPv4         | 10.1.2.13/30                 | 10.1.2.12/30 
R14    | e0/1 | IPv6         | 20FF:0DB8:ACAD:1012::14:1/64 | 20FF:0DB8:ACAD:1012::/64
R13    | e0/3 | IPv4         | 10.1.2.14/30                 | 10.1.2.12/30 
R13    | e0/3 | IPv6         | 20FF:0DB8:ACAD:1012::13:3/64 | 20FF:0DB8:ACAD:1012::/64
||||
R12    | e0/3 | IPv4         | 10.1.2.17/30                 | 10.1.2.16/30 
R12    | e0/3 | IPv6         | 20FF:0DB8:ACAD:1013::12:3/64 | 20FF:0DB8:ACAD:1013::/64
R15    | e0/1 | IPv4         | 10.1.2.18/30                 | 10.1.2.16/30 
R15    | e0/1 | IPv6         | 20FF:0DB8:ACAD:1013::15:1/64 | 20FF:0DB8:ACAD:1013::/64
||||
R15    | e0/0 | IPv4         | 10.1.2.26/30                 | 10.1.2.24/30 
R15    | e0/0 | IPv6         | 20FF:0DB8:ACAD:1014::15:/64  | 20FF:0DB8:ACAD:1014::/64
R13    | e0/2 | IPv4         | 10.1.2.25/30                 | 10.1.2.24/30 
R13    | e0/2 | IPv6         | 20FF:0DB8:ACAD:1014::13:2/64 | 20FF:0DB8:ACAD:1014::/64
||||
R15    | e0/3 | IPv4         | 10.1.2.29/30                 | 10.1.2.28/30 
R15    | e0/3 | IPv6         | 20FF:0DB8:ACAD:1015::15:3/64 | 20FF:0DB8:ACAD:1015::/64
R20    | e0/0 | IPv4         | 10.1.2.30/30                 | 10.1.2.28/30 
R20    | e0/0 | IPv6         | 20FF:0DB8:ACAD:1015::20:/64  | 20FF:0DB8:ACAD:1015::/64

#### СПБ  
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|------------------
R18    |10.2.1.2       |255.255.255.240 |20FF:0DB8:ACAD:2001::18/64|FE80::18/8
R17    |10.2.1.3       |255.255.255.240 |20FF:0DB8:ACAD:2001::17/64|FE80::17/8
R16    |10.2.1.4       |255.255.255.240 |20FF:0DB8:ACAD:2001::16/64|FE80::16/8
R32    |10.2.1.5       |255.255.255.240 |20FF:0DB8:ACAD:2001::32/64|FE80::32/8
SW9    |10.2.1.18      |255.255.255.248 |n/a                       |n/a
SW10   |10.2.1.19      |255.255.255.248 |n/a                       |n/a

Link
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R17    |e0/1  |IPv4          |10.2.2.1/30                   |10.2.2.0/30
R17    |e0/1  |IPv6          |20FF:0DB8:ACAD:2011::17:1/64  |20FF:0DB8:ACAD:2011::/64
R18    |e0/1  |IPv4          |10.2.2.2/30                   |10.2.2.0/30
R18    |e0/1  |IPv6          |20FF:0DB8:ACAD:2011::18:1/64  |20FF:0DB8:ACAD:2011::/64
||||
R18    |e0/0  |IPv4          |10.2.2.5/30                   |10.2.2.4/30
R18    |e0/0  |IPv6          |20FF:0DB8:ACAD:2012::18:/64   |20FF:0DB8:ACAD:2012::/64
R16    |e0/1  |IPv4          |10.2.2.6/30                   |10.2.2.4/30
R16    |e0/1  |IPv6          |20FF:0DB8:ACAD:2012::16:1/64  |20FF:0DB8:ACAD:2012::/64
||||
R16    |e0/3  |IPv4          |10.2.2.9/30                   |10.2.2.8/30
R16    |e0/3  |IPv6          |20FF:0DB8:ACAD:2013::16:3/64  |20FF:0DB8:ACAD:2013::/64
R32    |e0/0  |IPv4          |10.2.2.10/30                  |10.2.2.8/30
R32    |e0/0  |IPv6          |20FF:0DB8:ACAD:2013::32:/64   |20FF:0DB8:ACAD:2013::/64

#### Чокурдах  и Лабытнаги
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|------------------
R28    |10.3.1.2       |255.255.255.248 |20FF:0DB8:ACAD:3001::28/64|FE80::28/8
R27    |10.3.1.3       |255.255.255.248 |20FF:0DB8:ACAD:3001::27/64|FE80::27/8
SW29   |10.3.1.10      |255.255.255.248 |n/a                        |n/a

#### Триада
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|------------------
R23    |10.10.1.2      |255.255.255.248 |20FF:0DB8:ACAD:4001::23/64|FE80::23/8
R24    |10.10.1.3      |255.255.255.248 |20FF:0DB8:ACAD:4001::24/64|FE80::24/8
R25    |10.10.1.4      |255.255.255.248 |20FF:0DB8:ACAD:4001::25/64|FE80::25/8
R26    |10.10.1.5      |255.255.255.248 |20FF:0DB8:ACAD:4001::26/64|FE80::26/8

Link inside AS
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R23    |e0/1  |IPv4          |10.10.2.1/30                  |10.10.2.0/30
R23    |e0/1  |IPv6          |20FF:0DB8:ACAD:4011::23:1/64  |20FF:0DB8:ACAD:4011::/64
R25    |e0/0  |IPv4          |10.10.2.2/30                  |10.10.2.0/30
R25    |e0/0  |IPv6          |20FF:0DB8:ACAD:4011::25:/64   |20FF:0DB8:ACAD:4011::/64
||||
R25    |e0/2  |IPv4          |10.10.2.5/30                  |10.10.2.4/30
R25    |e0/2  |IPv6          |20FF:0DB8:ACAD:4012::25:2/64  |20FF:0DB8:ACAD:4012::/64
R26    |e0/2  |IPv4          |10.10.2.6/30                  |10.10.2.4/30
R26    |e0/2  |IPv6          |20FF:0DB8:ACAD:4012::26:2/64  |20FF:0DB8:ACAD:4000::/64
|||| 
R26    |e0/0  |IPv4          |10.10.2.9/30                  |10.10.2.8/30
R26    |e0/0  |IPv6          |20FF:0DB8:ACAD:4013::26:/64   |20FF:0DB8:ACAD:4013::/64
R24    |e0/1  |IPv4          |10.10.2.10/30                 |10.10.2.8/30
R24    |e0/1  |IPv6          |20FF:0DB8:ACAD:4013::24:1/64  |20FF:0DB8:ACAD:4013::/64
||||
R24    |e0/2  |IPv4          |10.10.2.13/30                 |10.10.2.12/30
R24    |e0/2  |IPv6          |20FF:0DB8:ACAD:4014::24:2/64  |20FF:0DB8:ACAD:4014::/64
R23    |e0/2  |IPv4          |10.10.2.14/30                 |10.10.2.12/30
R23    |e0/2  |IPv6          |20FF:0DB8:ACAD:4014::23:2/64  |20FF:0DB8:ACAD:4014::/64

Link outside AS
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R23    |e0/0  |IPv4          |50.50.1.1/30                  |50.50.1.0/30
R23    |e0/0  |IPv6          |20FF:0DB8:ACAD:7001::23:/64   |20FF:0DB8:ACAD:7001::/64
R22    |e0/2  |IPv4          |50.50.1.2/30                  |50.50.1.0/30
R22    |e0/2  |IPv6          |20FF:0DB8:ACAD:7001::22:2/64   |20FF:0DB8:ACAD:7001::/64
||||
R24    |e0/0  |IPv4          |50.50.1.5/30                  |50.50.1.4/30
R24    |e0/0  |IPv6          |20FF:0DB8:ACAD:7002::24:/64   |20FF:0DB8:ACAD:7002::/64
R21    |e0/2  |IPv4          |50.50.1.6/30                  |50.50.1.4/30
R21    |e0/2  |IPv6          |20FF:0DB8:ACAD:7002::21:2/64  |20FF:0DB8:ACAD:7002::/64
||||
R24    |e0/3  |IPv4          |50.50.1.9/30                  |50.50.1.8/30
R24    |e0/3  |IPv6          |20FF:0DB8:ACAD:7003::24:3/64  |20FF:0DB8:ACAD:7003::/64
R18    |e0/2  |IPv4          |50.50.1.10/30                 |50.50.1.12/30
R18    |e0/2  |IPv6          |20FF:0DB8:ACAD:7003::18:2/64  |20FF:0DB8:ACAD:7003::/64
||||
R26    |e0/3  |IPv4          |50.50.1.13/30                 |50.50.1.8/30
R26    |e0/3  |IPv6          |20FF:0DB8:ACAD:7004::26:3/64  |20FF:0DB8:ACAD:7004::/64
R18    |e0/3  |IPv4          |50.50.1.14/30                 |50.50.1.8/30
R18    |e0/3  |IPv6          |20FF:0DB8:ACAD:7004::18:3/64  |20FF:0DB8:ACAD:7004::/64
||||
R26    |e0/1  |IPv4          |50.50.1.17/30                 |50.50.1.16/30
R26    |e0/1  |IPv6          |20FF:0DB8:ACAD:7005::26:1/64  |20FF:0DB8:ACAD:7005::/64
R28    |e0/0  |IPv4          |50.50.1.18/30                 |50.50.1.16/30
R28    |e0/0  |IPv6          |20FF:0DB8:ACAD:7005::28:0/64  |20FF:0DB8:ACAD:7005::/64
||||
R25    |e0/3  |IPv4          |50.50.1.21/30                 |50.50.1.20/30
R25    |e0/3  |IPv6          |20FF:0DB8:ACAD:7006::25:3/64  |20FF:0DB8:ACAD:7006::/64
R28    |e0/1  |IPv4          |50.50.1.22/30                 |50.50.1.20/30
R28    |e0/1  |IPv6          |20FF:0DB8:ACAD:7006::28:1/64  |20FF:0DB8:ACAD:7006::/64
||||
R25    |e0/1  |IPv4          |50.50.1.25/30                 |50.50.1.24/30
R25    |e0/1  |IPv6          |20FF:0DB8:ACAD:7007::25:1/64  |20FF:0DB8:ACAD:7007::/64
R27    |e0/0  |IPv4          |50.50.1.26/30                 |50.50.1.24/30
R27    |e0/0  |IPv6          |20FF:0DB8:ACAD:7007::27:/64   |20FF:0DB8:ACAD:7007::/64

#### Киторн
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|------------------
R22    |10.11.1.2      |255.255.255.248 |20FF:ODB8:ACAD:5001::22/64|FE80::22/8

Link outside AS
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R22    |e0/0  |IPv4          |50.50.1.29/30                 |50.50.1.28/30
R22    |e0/0  |IPv6          |20FF:0DB8:ACAD:7008::22:/64   |20FF:0DB8:ACAD:7008::/64
R14    |e0/2  |IPv4          |50.50.1.30/30                 |50.50.1.28/30
R14    |e0/2  |IPv6          |20FF:0DB8:ACAD:7008::14:2/64  |20FF:0DB8:ACAD:7008::/64
||||
R22    |e0/1  |IPv4          |50.50.1.33/30                 |50.50.1.32/30
R22    |e0/1  |IPv6          |20FF:0DB8:ACAD:7009::22:1/64  |20FF:0DB8:ACAD:7009::/64
R21    |e0/1  |IPv4          |50.50.1.34/30                 |50.50.1.32/30
R21    |e0/1  |IPv6          |20FF:0DB8:ACAD:7009::21:1/64  |20FF:0DB8:ACAD:7009::/64

#### Ламас
Management
Device | IPv4 Address  | Subnet Mask    | IPv6 GLA Address         | IPv6 LLA Address
-------|---------------|----------------|--------------------------|------------------
R21    |10.12.1.2      |255.255.255.248 |20FF:0DB8:ACAD:6001::21/64|FE80::21/8

Link outside AS
Device | Port | Address type | Address                      | Network
------ |------|--------------|------------------------------|---------
R21    |e0/0  |IPv4          |50.50.1.37/30                 |50.50.1.36/30
R21    |e0/0  |IPv6          |20FF:0DB8:ACAD:7010::21:/64   |20FF:0DB8:ACAD:7010::/64
R15    |e0/2  |IPv4          |50.50.1.38/30                 |50.50.1.36/30
R15    |e0/2  |IPv6          |20FF:0DB8:ACAD:7010::15:2/64  |20FF:0DB8:ACAD:7010::/64

### Часть 2. Настройка маршрутизаторов.
В этой части были настроены все маршрутизаторы лабораторного стенда
Пример настройки маршрутизатора R14
```
hostname R14
ip routing
ipv6 unicast-routing

interface Loopback1
 description manage
 ip address 10.1.1.3 255.255.255.240
 ipv6 address FE80::14 link-local
 ipv6 address 20FF:DB8:ACAD:1001::14/64
 ipv6 enable
!
interface Ethernet0/0
 description to R12
 ip address 10.1.2.9 255.255.255.252
 ipv6 address FE80::14 link-local
 ipv6 address 20FF:DB8:ACAD:1011::14:0/64
 ipv6 enable
!
interface Ethernet0/1
 description to R13
 ip address 10.1.2.13 255.255.255.252
 ipv6 address FE80::14 link-local
 ipv6 address 20FF:DB8:ACAD:1012::14:1/64
 ipv6 enable
!
interface Ethernet0/2
 description to R22
 ip address 50.50.1.38 255.255.255.252
 ipv6 address FE80::14 link-local
 ipv6 address 20FF:DB8:ACAD:7008::14:2/64
 ipv6 enable
!
interface Ethernet0/3
 description to R19
 ip address 10.1.2.2 255.255.255.252
 ipv6 address FE80::14 link-local
 ipv6 address 20FF:DB8:ACAD:1000::14:3/64
 ipv6 enable
!
```
### Часть 3. Настройка VLAN, InterVLAN routing, VPC.
Таблица VLAN

Device | VLAN | Address      | Network                      | Coment
------ |------|--------------|------------------------------|---------
R28    |30    |10.3.1.9      |10.3.1.0/29                   |Gateway vlan 30
R28    |31    |10.3.3.1      |10.3.3.0/28                   |Gateway vlan 31
R28    |32    |10.3.3.17     |10.3.3.16/28                  |Gateway vlan 32
SW29   |30    |10.3.1.10     |10.3.1.0/29                   |Manage SW29
VPC30  |31    |10.3.3.2      |10.3.3.0/28                   |Address VPC30
VPC31  |32    |10.3.3.18     |10.3.3.16/28                  |Address VPC31

